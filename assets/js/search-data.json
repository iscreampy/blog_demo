{
  
    
        "post0": {
            "title": "How to extract data from pd Dataframe (Part I)",
            "content": "import pandas as pd . df = pd.read_csv(&#39;./data/jamesbond.csv&#39;) df.head() . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 Thunderball | 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 Casino Royale | 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . How to extract rows . set_index and reset_index . read_csv method has an index_col parameter that lets you set an index for your dataframe | Remember that the index of a dataframe is allowed to have duplicate values. That&#39;s what makes a dataframe significantly more powerful than a python dictionary. | . df = pd.read_csv(&#39;./data/jamesbond.csv&#39;, index_col=&#39;Film&#39;) df.head(3) . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . df = pd.read_csv(&#39;./data/jamesbond.csv&#39;) df.head(3) . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . You can also set the index after loading the dataset as well. . df.set_index(&#39;Film&#39;) . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . You Only Live Twice 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . On Her Majesty&#39;s Secret Service 1969 | George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Live and Let Die 1973 | Roger Moore | Guy Hamilton | 460.3 | 30.8 | NaN | . The Man with the Golden Gun 1974 | Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . The Spy Who Loved Me 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . Moonraker 1979 | Roger Moore | Lewis Gilbert | 535.0 | 91.5 | NaN | . For Your Eyes Only 1981 | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . Never Say Never Again 1983 | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . Octopussy 1983 | Roger Moore | John Glen | 373.8 | 53.9 | 7.8 | . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . The Living Daylights 1987 | Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . Licence to Kill 1989 | Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . GoldenEye 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . Tomorrow Never Dies 1997 | Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . The World Is Not Enough 1999 | Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Quantum of Solace 2008 | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . Skyfall 2012 | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . Spectre 2015 | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . df.set_index(&#39;Film&#39;, inplace=True) . If you wanted to undo or reset the index to pandas default numeric index, then... . df.reset_index() . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 Thunderball | 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 Casino Royale | 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . 5 You Only Live Twice | 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 6 On Her Majesty&#39;s Secret Service | 1969 | George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . 7 Diamonds Are Forever | 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . 8 Live and Let Die | 1973 | Roger Moore | Guy Hamilton | 460.3 | 30.8 | NaN | . 9 The Man with the Golden Gun | 1974 | Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . 10 The Spy Who Loved Me | 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . 11 Moonraker | 1979 | Roger Moore | Lewis Gilbert | 535.0 | 91.5 | NaN | . 12 For Your Eyes Only | 1981 | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . 13 Never Say Never Again | 1983 | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . 14 Octopussy | 1983 | Roger Moore | John Glen | 373.8 | 53.9 | 7.8 | . 15 A View to a Kill | 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . 16 The Living Daylights | 1987 | Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . 17 Licence to Kill | 1989 | Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . 18 GoldenEye | 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . 19 Tomorrow Never Dies | 1997 | Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . 20 The World Is Not Enough | 1999 | Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . 21 Die Another Day | 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . 22 Casino Royale | 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . 23 Quantum of Solace | 2008 | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . 24 Skyfall | 2012 | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . 25 Spectre | 2015 | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . Pay attention to the parameters of the reset_index() method here. There is something called drop parameter which lets you drop the previous index. By default it is set to False so you won&#39;t see it missing when you reset the index. However, you could delete the old index by changing the drop=True though :) . df.reset_index(drop=True) . Year Actor Director Box Office Budget Bond Actor Salary . 0 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . 5 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 6 1969 | George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . 7 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . 8 1973 | Roger Moore | Guy Hamilton | 460.3 | 30.8 | NaN | . 9 1974 | Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . 10 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . 11 1979 | Roger Moore | Lewis Gilbert | 535.0 | 91.5 | NaN | . 12 1981 | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . 13 1983 | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . 14 1983 | Roger Moore | John Glen | 373.8 | 53.9 | 7.8 | . 15 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . 16 1987 | Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . 17 1989 | Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . 18 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . 19 1997 | Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . 20 1999 | Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . 21 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . 22 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . 23 2008 | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . 24 2012 | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . 25 2015 | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . df.head() . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . We can see clearly that Film column is the index for this dataframe. Now let&#39;s say you want to set someother column as the index (say Year) and not Film. We could do this: . df.set_index(&#39;Year&#39;) . Actor Director Box Office Budget Bond Actor Salary . Year . 1962 Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1963 Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 1964 Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 1965 Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 1967 David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . 1967 Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 1969 George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . 1971 Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . 1973 Roger Moore | Guy Hamilton | 460.3 | 30.8 | NaN | . 1974 Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . 1977 Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . 1979 Roger Moore | Lewis Gilbert | 535.0 | 91.5 | NaN | . 1981 Roger Moore | John Glen | 449.4 | 60.2 | NaN | . 1983 Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . 1983 Roger Moore | John Glen | 373.8 | 53.9 | 7.8 | . 1985 Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . 1987 Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . 1989 Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . 1995 Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . 1997 Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . 1999 Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . 2002 Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . 2006 Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . 2008 Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . 2012 Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . 2015 Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . Notice that this operation dropped our old index by default! This is not what we wanted so let&#39;s see how we can fix this... . df.reset_index().set_index(&#39;Year&#39;) . Film Actor Director Box Office Budget Bond Actor Salary . Year . 1962 Dr. No | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1963 From Russia with Love | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 1964 Goldfinger | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 1965 Thunderball | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 1967 Casino Royale | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . 1967 You Only Live Twice | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 1969 On Her Majesty&#39;s Secret Service | George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . 1971 Diamonds Are Forever | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . 1973 Live and Let Die | Roger Moore | Guy Hamilton | 460.3 | 30.8 | NaN | . 1974 The Man with the Golden Gun | Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . 1977 The Spy Who Loved Me | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . 1979 Moonraker | Roger Moore | Lewis Gilbert | 535.0 | 91.5 | NaN | . 1981 For Your Eyes Only | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . 1983 Never Say Never Again | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . 1983 Octopussy | Roger Moore | John Glen | 373.8 | 53.9 | 7.8 | . 1985 A View to a Kill | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . 1987 The Living Daylights | Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . 1989 Licence to Kill | Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . 1995 GoldenEye | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . 1997 Tomorrow Never Dies | Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . 1999 The World Is Not Enough | Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . 2002 Die Another Day | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . 2006 Casino Royale | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . 2008 Quantum of Solace | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . 2012 Skyfall | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . 2015 Spectre | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . Retrieve rows by index label using .loc[] accessor . df.head() . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Tip . One optimisation that one can always help in Pandas is to sort the dataframe by the index. | It is a lot easier for pandas to find a value in a sorted dataframe than it is to find it in a randomly ordered dataframe. | . df.sort_index(inplace=True) df.head() . Year Actor Director Box Office Budget Bond Actor Salary . Film . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . One can access a row in a Series by its label or its index position by placing that label or index position within square brackets. | When it comes to a dataframe, we need to preceed that square bracket with a .loc accessor. | . df.loc[&#39;Casino Royale&#39;] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . df.loc[&#39;Goldfinger&#39;] . Year 1964 Actor Sean Connery Director Guy Hamilton Box Office 820.4 Budget 18.6 Bond Actor Salary 3.2 Name: Goldfinger, dtype: object . We can extract all index labels in between two movies like this . df.loc[&#39;Diamonds Are Forever&#39;:&#39;License To Kill&#39;] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . For Your Eyes Only 1981 | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . GoldenEye 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Licence to Kill 1989 | Timothy Dalton | John Glen | 250.9 | 56.7 | 7.9 | . Notice how this slicing is different from list slicing. In list slicing, the last value in the slicing is excluded. However, here the last value in the slice is included in the result. | Building off of list slicing syntax, we can extract slices that skip a few movies by steps. | . df.loc[&#39;Diamonds Are Forever&#39;:&#39;License To Kill&#39;:2] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . As you can imagine, we can also use other list slicing techniques here. We can pull all data from a given point to the very end of the dataframe | . df.loc[&#39;Quantum of Solace&#39;:] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Quantum of Solace 2008 | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . Skyfall 2012 | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . Spectre 2015 | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . The Living Daylights 1987 | Timothy Dalton | John Glen | 313.5 | 68.8 | 5.2 | . The Man with the Golden Gun 1974 | Roger Moore | Guy Hamilton | 334.0 | 27.7 | NaN | . The Spy Who Loved Me 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . The World Is Not Enough 1999 | Pierce Brosnan | Michael Apted | 439.5 | 158.3 | 13.5 | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . Tomorrow Never Dies 1997 | Pierce Brosnan | Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . You Only Live Twice 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . You can also extract data from the beginning of the dataframe upto a certain point | . df.loc[:&#39;GoldenEye&#39;] . Year Actor Director Box Office Budget Bond Actor Salary . Film . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . For Your Eyes Only 1981 | Roger Moore | John Glen | 449.4 | 60.2 | NaN | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . GoldenEye 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . You can extract more than one index labels from the dataframe like this: | . df.loc[[&#39;GoldenEye&#39;, &#39;Casino Royale&#39;, &#39;Dr. No&#39;]] . Year Actor Director Box Office Budget Bond Actor Salary . Film . GoldenEye 1995 | Pierce Brosnan | Martin Campbell | 518.5 | 76.9 | 5.1 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . Retrieve rows by index position using iloc accessor . We are going to need the standard numeric pandas index. So we will have to reset the index: . df.reset_index(inplace=True) . df.iloc[0] . Film A View to a Kill Year 1985 Actor Roger Moore Director John Glen Box Office 275.2 Budget 54.5 Bond Actor Salary 9.1 Name: 0, dtype: object . Remember that we previously sorted the dataframe on the Name index. Hence the first value we retrieve is &quot;A View to a Kill&quot;. However let&#39;s load the dataframe again using the read_csv function . df = pd.read_csv(&#39;./data/jamesbond.csv&#39;) df.head() . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 Thunderball | 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 Casino Royale | 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . df.iloc[0] . Film Dr. No Year 1962 Actor Sean Connery Director Terence Young Box Office 448.8 Budget 7 Bond Actor Salary 0.6 Name: 0, dtype: object . Similar to loc we can extract multiple rows using a python list like so: . df.iloc[[0, 5, 10, 15]] . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 5 You Only Live Twice | 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 10 The Spy Who Loved Me | 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . 15 A View to a Kill | 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . As you can guess, we can extract rows between certain index position values as well! . df.iloc[1:8] . Film Year Actor Director Box Office Budget Bond Actor Salary . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 Thunderball | 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 Casino Royale | 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . 5 You Only Live Twice | 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . 6 On Her Majesty&#39;s Secret Service | 1969 | George Lazenby | Peter R. Hunt | 291.5 | 37.3 | 0.6 | . 7 Diamonds Are Forever | 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . (Difference between loc and iloc) . Caveat: Notice here that the last row mentioned in the slice will not be included just like a python list slicing! . df.iloc[21:] . Film Year Actor Director Box Office Budget Bond Actor Salary . 21 Die Another Day | 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . 22 Casino Royale | 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . 23 Quantum of Solace | 2008 | Daniel Craig | Marc Forster | 514.2 | 181.4 | 8.1 | . 24 Skyfall | 2012 | Daniel Craig | Sam Mendes | 943.5 | 170.2 | 14.5 | . 25 Spectre | 2015 | Daniel Craig | Sam Mendes | 726.7 | 206.3 | NaN | . df.iloc[:5] . Film Year Actor Director Box Office Budget Bond Actor Salary . 0 Dr. No | 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . 1 From Russia with Love | 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . 2 Goldfinger | 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . 3 Thunderball | 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . 4 Casino Royale | 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Note: . Integer indexes exist even if your dataframe has its index set to a non-integer index. Let me demonstrate what I mean here: . df.set_index(&#39;Film&#39;, inplace=True) . df.head(3) . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . df.iloc[[0, 5, 10, 15]] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . You Only Live Twice 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . The Spy Who Loved Me 1977 | Roger Moore | Lewis Gilbert | 533.0 | 45.1 | NaN | . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . df.iloc[:5] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | 0.6 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Notice how the integer index syntax still works regardless of what we set our index to be! . Summary: . You can slice a pandas dataframe in the same number of ways as you can slice python list. Just remember to use either loc or iloc accessor(s)! | Remember to use square brackets while using these properties and not parantheses like we are so used to! | . How to extract columns (and rows) . df.sort_index(inplace=True) df.head() . Year Actor Director Box Office Budget Bond Actor Salary . Film . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . df.loc[&#39;Die Another Day&#39;] . Year 2002 Actor Pierce Brosnan Director Lee Tamahori Box Office 465.4 Budget 154.2 Bond Actor Salary 17.9 Name: Die Another Day, dtype: object . What if we wanted to extract the actor information only? It&#39;s simple! . df.loc[&#39;Die Another Day&#39;, &#39;Actor&#39;] . &#39;Pierce Brosnan&#39; . Now say we wanted to know the director as well as the box office returns for this movie? That&#39;s simple too! . df.loc[&#39;Die Another Day&#39;, [&#39;Director&#39;, &#39;Box Office&#39;]] . Director Lee Tamahori Box Office 465.4 Name: Die Another Day, dtype: object . What if we wanted this information for Moonraker movie as well? . df.loc[[&#39;Moonraker&#39;, &#39;Die Another Day&#39;], [&#39;Director&#39;, &#39;Box Office&#39;]] . Director Box Office . Film . Moonraker Lewis Gilbert | 535.0 | . Die Another Day Lee Tamahori | 465.4 | . Pandas is remarkably flexible with slicing is it is completely acceptable to do this: . df.loc[&#39;Moonraker&#39;, &#39;Director&#39;:&#39;Budget&#39;] . Director Lewis Gilbert Box Office 535 Budget 91.5 Name: Moonraker, dtype: object . df.loc[&#39;Moonraker&#39;:&#39;Thunderball&#39;, &#39;Director&#39;:&#39;Budget&#39;] . Director Box Office Budget . Film . Moonraker Lewis Gilbert | 535.0 | 91.5 | . Never Say Never Again Irvin Kershner | 380.0 | 86.0 | . Octopussy John Glen | 373.8 | 53.9 | . On Her Majesty&#39;s Secret Service Peter R. Hunt | 291.5 | 37.3 | . Quantum of Solace Marc Forster | 514.2 | 181.4 | . Skyfall Sam Mendes | 943.5 | 170.2 | . Spectre Sam Mendes | 726.7 | 206.3 | . The Living Daylights John Glen | 313.5 | 68.8 | . The Man with the Golden Gun Guy Hamilton | 334.0 | 27.7 | . The Spy Who Loved Me Lewis Gilbert | 533.0 | 45.1 | . The World Is Not Enough Michael Apted | 439.5 | 158.3 | . Thunderball Terence Young | 848.1 | 41.9 | . df.loc[&#39;Spectre&#39;:, &#39;Director&#39;:] . Director Box Office Budget Bond Actor Salary . Film . Spectre Sam Mendes | 726.7 | 206.3 | NaN | . The Living Daylights John Glen | 313.5 | 68.8 | 5.2 | . The Man with the Golden Gun Guy Hamilton | 334.0 | 27.7 | NaN | . The Spy Who Loved Me Lewis Gilbert | 533.0 | 45.1 | NaN | . The World Is Not Enough Michael Apted | 439.5 | 158.3 | 13.5 | . Thunderball Terence Young | 848.1 | 41.9 | 4.7 | . Tomorrow Never Dies Roger Spottiswoode | 463.2 | 133.9 | 10.0 | . You Only Live Twice Lewis Gilbert | 514.2 | 59.9 | 4.4 | . df.loc[:&#39;Dr. No&#39;, :&#39;Budget&#39;] . Year Actor Director Box Office Budget . Film . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | . Dr. No 1962 | Sean Connery | Terence Young | 448.8 | 7.0 | . Now predictably, we can extend this behaviour to integer indexes too. . df.iloc[14, 2] . &#39;John Glen&#39; . df.iloc[14, 2:5] . Director John Glen Box Office 373.8 Budget 53.9 Name: Octopussy, dtype: object . df.iloc[:5, :3] . Year Actor Director . Film . A View to a Kill 1985 | Roger Moore | John Glen | . Casino Royale 2006 | Daniel Craig | Martin Campbell | . Casino Royale 1967 | David Niven | Ken Hughes | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | . Summary: . First argument to loc or iloc : rows | Second argument to loc or iloc : columns | . Set values . Set a new value to specific cell . df.head() . Year Actor Director Box Office Budget Bond Actor Salary . Film . A View to a Kill 1985 | Roger Moore | John Glen | 275.2 | 54.5 | 9.1 | . Casino Royale 2006 | Daniel Craig | Martin Campbell | 581.5 | 145.3 | 3.3 | . Casino Royale 1967 | David Niven | Ken Hughes | 315.0 | 85.0 | NaN | . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . Die Another Day 2002 | Pierce Brosnan | Lee Tamahori | 465.4 | 154.2 | 17.9 | . df.loc[&#39;Dr. No&#39;, &#39;Actor&#39;] . &#39;Sean Connery&#39; . df.loc[&#39;Dr. No&#39;, &#39;Actor&#39;] = &#39;Sir Sean Connery&#39; . df.loc[&#39;Dr. No&#39;, &#39;Actor&#39;] . &#39;Sir Sean Connery&#39; . Say we wanted to replace multiple values inside the same row: . df.loc[&#39;Dr. No&#39;, [&#39;Box Office&#39;, &#39;Budget&#39;, &#39;Bond Actor Salary&#39;]] = [448000000, 7000000, 600000] . df.loc[&#39;Dr. No&#39;, &#39;Box Office&#39;] . 448000000.0 . Set multiple values in Dataframe . Let&#39;s change Sean Connery&#39;s name to Sir Sean Connery . df = pd.read_csv(&#39;./data/jamesbond.csv&#39;, index_col=&#39;Film&#39;) df.head(3) . df[df[&#39;Actor&#39;] == &#39;Sean Connery&#39;] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Never Say Never Again 1983 | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . You Only Live Twice 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . connery_mask = df[&#39;Actor&#39;] == &#39;Sean Connery&#39; df[connery_mask] . Year Actor Director Box Office Budget Bond Actor Salary . Film . Diamonds Are Forever 1971 | Sean Connery | Guy Hamilton | 442.5 | 34.7 | 5.8 | . From Russia with Love 1963 | Sean Connery | Terence Young | 543.8 | 12.6 | 1.6 | . Goldfinger 1964 | Sean Connery | Guy Hamilton | 820.4 | 18.6 | 3.2 | . Never Say Never Again 1983 | Sean Connery | Irvin Kershner | 380.0 | 86.0 | NaN | . Thunderball 1965 | Sean Connery | Terence Young | 848.1 | 41.9 | 4.7 | . You Only Live Twice 1967 | Sean Connery | Lewis Gilbert | 514.2 | 59.9 | 4.4 | . Wrong way to replace values . df[connery_mask][&#39;Actor&#39;] . Film Diamonds Are Forever Sean Connery From Russia with Love Sean Connery Goldfinger Sean Connery Never Say Never Again Sean Connery Thunderball Sean Connery You Only Live Twice Sean Connery Name: Actor, dtype: object . df[connery_mask][&#39;Actor&#39;] = &#39;Sir Sean Connery&#39; . /Users/h20/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame. Try using .loc[row_indexer,col_indexer] = value instead See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy &#34;&#34;&#34;Entry point for launching an IPython kernel. . df[connery_mask][&#39;Actor&#39;] . Film Diamonds Are Forever Sean Connery From Russia with Love Sean Connery Goldfinger Sean Connery Never Say Never Again Sean Connery Thunderball Sean Connery You Only Live Twice Sean Connery Name: Actor, dtype: object . Nothing changed. Why? If you read the warning it says a value is trying to be set on a copy of a dataframe. That&#39;s the problem here. We want our changes to be reflected on the original dataframe and not a copy of it! . Right way to change values . df.loc[connery_mask, &#39;Actor&#39;] . Film Diamonds Are Forever Sean Connery From Russia with Love Sean Connery Goldfinger Sean Connery Never Say Never Again Sean Connery Thunderball Sean Connery You Only Live Twice Sean Connery Name: Actor, dtype: object . df.loc[connery_mask, &#39;Actor&#39;] = &#39;Sir Sean Connery&#39; . df.loc[connery_mask, &#39;Actor&#39;] . Film Diamonds Are Forever Sir Sean Connery From Russia with Love Sir Sean Connery Goldfinger Sir Sean Connery Never Say Never Again Sir Sean Connery Thunderball Sir Sean Connery You Only Live Twice Sir Sean Connery Name: Actor, dtype: object . Hopefully this tutorial was helpful in someway! Check out part II of this tutorial to learn how to rename columns/index labels, delete rows and columns, filter dataframes, using the apply function and more!! .",
            "url": "iscreampy.com/2021/08/11/DAP_Dataframes3.html",
            "relUrl": "/2021/08/11/DAP_Dataframes3.html",
            "date": " • Aug 11, 2021"
        }
        
    
  
    
        ,"post1": {
            "title": "First_post",
            "content": "Hello World! . This is my blog. These are my thoughts, this is me. .",
            "url": "iscreampy.com/2021/06/10/first_post.html",
            "relUrl": "/2021/06/10/first_post.html",
            "date": " • Jun 10, 2021"
        }
        
    
  
    
        ,"post2": {
            "title": "An Example Markdown Post",
            "content": "Example Markdown Post . Basic setup . Jekyll requires blog post files to be named according to the following format: . YEAR-MONTH-DAY-filename.md . Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and filename is whatever file name you choose, to remind yourself what this post is about. .md is the file extension for markdown files. . The first line of the file should start with a single hash character, then a space, then your title. This is how you create a “level 1 heading” in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line ## File names above. . Basic formatting . You can use italics, bold, code font text, and create links. Here’s a footnote 1. Here’s a horizontal rule: . . Lists . Here’s a list: . item 1 | item 2 | . And a numbered list: . item 1 | item 2 | Boxes and stuff . This is a quotation . . You can include alert boxes …and… . . You can include info boxes Images . . Code . You can format text and code per usual . General preformatted text: . # Do a thing do_thing() . Python code and output: . # Prints &#39;2&#39; print(1+1) . 2 . Formatting text as shell commands: . echo &quot;hello world&quot; ./some_script.sh --option &quot;value&quot; wget https://example.com/cat_photo1.png . Formatting text as YAML: . key: value - another_key: &quot;another value&quot; . Tables . Column 1 Column 2 . A thing | Another thing | . Tweetcards . Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Footnotes . This is the footnote. &#8617; . |",
            "url": "iscreampy.com/markdown/2020/01/14/test-markdown-post.html",
            "relUrl": "/markdown/2020/01/14/test-markdown-post.html",
            "date": " • Jan 14, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "iscreampy.com/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "iscreampy.com/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}